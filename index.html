<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>Member Profile</title>
  <script src="https://unpkg.com/html5-qrcode" type="text/javascript"></script>
  <link rel="stylesheet" href="style.css" />
</head>
<body>
  <div class="profile-container">
    <div id="terms-section" class="terms-section">
      <label style="display:flex;align-items:center;gap:8px;font-size:1em;margin-bottom:18px;">
        <input type="checkbox" id="acceptTerms" style="width:18px;height:18px;" />
        I accept the <a href="terms.html" target="_blank" style="color:#005fa3;text-decoration:underline;">Terms and Privacy Policy</a>
      </label>
      <button id="proceedBtn" style="padding:0.6em 1.5em;font-size:1em;border-radius:8px;border:2px solid #005fa3;background:#fff;color:#005fa3;cursor:pointer;transition:background 0.2s, color 0.2s;">Proceed</button>
    </div>
    <div id="scanner-section" class="scanner-section" style="display:none;">
      <h2>New Gym</h2>
      <div id="qrScanner"></div>
      <div id="scanStatus">Scan QR code to add a new Gym</div>
    </div>
  </div>
  <script src="https://cdn.jsdelivr.net/npm/qrcode@1.5.0/build/qrcode.min.js"></script>
  <script src="qr-reader.js"></script>
  <script>
    document.addEventListener('DOMContentLoaded', function() {
      const termsSection = document.getElementById('terms-section');
      const scannerSection = document.getElementById('scanner-section');
      const profileSection = document.getElementById('profile-section');
      const proceedBtn = document.getElementById('proceedBtn');
      const acceptTerms = document.getElementById('acceptTerms');

      // Check localStorage for acceptance
      const termsAccepted = localStorage.getItem('termsAccepted') === 'true';
      const hasProfile = !!localStorage.getItem('memberProfile');

      if (termsAccepted) {
        termsSection.style.display = 'none';
        if (hasProfile) {
          // Redirect to profile.html if profile exists and terms accepted
          window.location.href = 'profile.html';
          return;
        } else {
          scannerSection.style.display = '';
          profileSection.style.display = 'none';
        }
      } else {
        termsSection.style.display = '';
        scannerSection.style.display = 'none';
      }

      // Only show scanner if terms accepted
      proceedBtn.onclick = function() {
        if (acceptTerms.checked) {
          localStorage.setItem('termsAccepted', 'true');
          termsSection.style.display = 'none';
          if (localStorage.getItem('memberProfile')) {
            scannerSection.style.display = 'none';
            profileSection.style.display = '';
          } else {
            scannerSection.style.display = '';
            profileSection.style.display = 'none';
          }
        } else {
          alert('You must accept the Terms and Privacy Policy to continue.');
        }
      };
    });
  </script>
</body>
</html>